# the Directive is a complete description of your application, including all of its business logic.

# replace 'suborbital' with your organization name, and ensure the version is updated for each deploy!
identifier: com.suborbital.important-api
appVersion: v0.0.1
atmoVersion: v0.1.0

handlers:
  - type: request
    resource: /stars/*repo
    method: GET
    steps:
      - fn: ghstars
        onErr:
          code:
              404: continue

  - type: request
    resource: /repo/report/*repo
    method: POST
    steps:
      - fn: ghstars
        as: stargazers

      - fn: send-report


schedules:
  - name: atmo-report
    every:
      hours: 1
    state:
      repo: suborbital/atmo
    steps:
      - fn: ghstars
        as: stargazers

      - fn: send-report


  - name: reactr-report
    every:
      hours: 1
    state:
      repo: suborbital/reactr
    steps:
      - fn: ghstars
        as: stargazers

      - fn: send-report

  - name: grav-report
    every:
      hours: 1
    state:
      repo: suborbital/grav
    steps:
      - fn: ghstars
        as: stargazers

      - fn: send-report